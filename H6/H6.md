# H6

### Kurssin tehtävät:
* [Repository:n pääsivu](https://github.com/mikorpi/Pentest-2020-Autumn)
* [Harjoitus 1/WebGoat](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H1.md)
* [Harjoitus 2/OWASP10/WebGoat/MITRE](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H2.md)
* [Harjoitus 3/Aktiivinen tiedustelu](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H3.md)
* [Harjoitus 4/HTB-läpikäyntejä & työkaluja](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H4.md)
* [Harjoitus 5/Metasploit-framework & Metasploitable2](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H5/H5.md)

![hcat](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H6/images/hashcat.png)

### [Hashcat](https://hashcat.net/hashcat/)
* Hashcat on salasanojen/tiivisteiden murtotyökalu.
* "Edistynyttä salasanan palautusta"

Tässä tehtävässä murretaan tiivisteitä. Syystä tai toisesta Hashcat ei halunnut toimia virtuaalikoneellani joten latasin sen varsinaiselle koneelleni (Windows10). Näytönohjaimena toimii `GeForce GTX 1060 6GB`.

#### MD5-tiivisteen murtaminen sanalistalla:

Jotta tämä ei ole liian helponnäköistä, loin MD5-tiivisteen Kali-virtuaalikoneessani.

`$ echo -n "moikkakaikille!!!" | md5sum | tr -d " -" >> hash.txt`

Murretaan edelliskohdassa tehty MD5-tiiviste omalla kustomoidulla sanalistalla Windows:issa. `-m`-parametri kertoo mitä modea käytetään, 0 on MD5:selle:

`C:\>hashcat.exe -m 0 hash.txt sanalista.txt `

![hashcatmd5](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H6/images/md5_moikkakaikille.png)

Kustomoitu sanalistani oli pieni, hashcat ei päässyt täyteen vauhtiin mutta sai hommansa tehtyä.

#### MD5-tiivisteen murtaminen Mask-hyökkäyksellä:

Mask-hyökkäys on kuin bruteforce-hyökkäys mutta spesifimpi. Pääset valitsemaan "maskeja" jotta hashcat:in ei tarvitse paukuttaa bruteforcella jokaista merkkiä. Tätä hyökkäystyyppiä on hyvä käyttää jos tiedossasi on murron kohteena olevan salasanan piirteitä (lue: salasanapolitiikka), esim. että se loppuu kahdella numerolla, alkaa isolla alkukirjaimella ja niin edespäin. [Lisää tietoa täältä.](https://hashcat.net/wiki/doku.php?id=mask_attack)

Luodaan MD5-tiiviste sanasta:

`salainen`. `$ echo -n "salainen" | md5sum | tr -d " -" >> hash.txt`

Esimerkki: Olemme saaneet selville että kohteen salasanat on hashattu MD5:sella ja ne ovat 8 merkkiä pitkiä ja sisältävät vain pieniä kirjaimia. Täten maskimme tulee kattaa 8 merkkiä, ja asetamme sen kokeilemaan aakkosia(ASCII) pienellä(lowercase).

Hashcat:in sisäänrakennetut merkkisarjat:
```
?l = abcdefghijklmnopqrstuvwxyz
?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ
?d = 0123456789
?h = 0123456789abcdef
?H = 0123456789ABCDEF
?s = «space»!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~
?a = ?l?u?d?s
?b = 0x00 – 0xff
```
Olemme myös hyvin laiskoja kirjoittamaan joten:
```
$ python3                  
Python 3.8.6 (default, Sep 25 2020, 09:36:53)                                                                                 
[GCC 10.2.0] on linux                                                                                             
Type "help", "copyright", "credits" or "license" for more information.                                                               
>>> "?l" * 8                                                   
'?l?l?l?l?l?l?l?l'
>>>                                        
```

laitetaan hashcat tulille Windows10-koneella. Huomaa että `attackmode` on 3 eli bruteforce.

`C:\>hashcat.exe -m 0 -a 3 hash.txt ?l?l?l?l?l?l?l?l`

![hashcat_maskattack](https://github.com/mikorpi/Pentest-2020-Autumn/blob/main/H6/images/md5_maskattack.png)

Success. Hashcat mursi tiivisteen yhdeksässä sekunnissa. `2980b5745aa680af4465eae059992bd3:salainen`


#### SHA512 murtoa sanalistalla

* Luodaan testikäyttäjä : `$ sudo adduser crackme`
* `$ cat /etc/shadow | grep "crackme" >> hash.txt` siirretään crackme-käyttäjän tiiviste hash.txt:iin. Muista kumittaa `käyttäjätunnus:` pois!
* `crackme:$6$uS8nG8u3v5J1Zo0x$qaKw3ZJP1abKrFemi7O2WkzjYuEEpKGBB7s57hDaTodlRoGTEYrhXAafTxRP1uyKKtLUzFFMHrgfv4xKPNhv7.:18608:0:99999:7:::`
* Ylempi avattuna : `Käyttäjätunnus$salasanatyyppi$SALT$SALASANA...` eli crackme,SHA-512,suola = `uS8nG8u3v5J1Zo0x`.

Sanalistana https://weakpass.com/wordlist/1850
